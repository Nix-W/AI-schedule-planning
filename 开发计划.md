# 项目名称：AI 个人日程规划系统

> 开发周期：约 5 天  
> 技术栈：Next.js + React + TypeScript + Claude API + react-big-calendar

---

## 里程碑1：项目初始化 + 数据结构定义

**目标**：搭建项目骨架，定义前后端共用的类型系统

### 验收标准
在终端看到项目成功启动，TypeScript 编译无报错

### 验收代码
```bash
# 1. 创建项目
npx create-next-app@latest ai-calendar --typescript --tailwind --eslint --app

# 2. 进入项目目录
cd ai-calendar

# 3. 安装依赖
npm install react-big-calendar date-fns @anthropic-ai/sdk
npm install -D @types/react-big-calendar

# 4. 检查类型定义
npx tsc --noEmit

# 5. 启动项目
npm run dev
```

### 预期结果
```
✓ Ready in 2.1s
○ Compiling / ...
✓ Compiled / in 1.2s
- Local: http://localhost:3000
```
浏览器访问 `http://localhost:3000` 显示 Next.js 默认页面，终端无 TypeScript 报错

---

## 里程碑2：AI 解析服务（后端 API）

**目标**：实现自然语言解析接口，调用 Claude API 返回结构化日程数据

### 验收标准
在终端通过 curl 调用 API，返回正确的 JSON 结构

### 验收代码
```bash
# 测试1：基础日程解析
curl -X POST http://localhost:3000/api/parse-event \
  -H "Content-Type: application/json" \
  -d '{"text": "明天下午3点开会"}'

# 测试2：带地点和参与者
curl -X POST http://localhost:3000/api/parse-event \
  -H "Content-Type: application/json" \
  -d '{"text": "下周三和老王在星巴克讨论项目"}'

# 测试3：重复日程
curl -X POST http://localhost:3000/api/parse-event \
  -H "Content-Type: application/json" \
  -d '{"text": "每周一早上9点站会，30分钟"}'

# 测试4：全天事件
curl -X POST http://localhost:3000/api/parse-event \
  -H "Content-Type: application/json" \
  -d '{"text": "1月30号全天休假"}'

# 测试5：空输入（错误处理）
curl -X POST http://localhost:3000/api/parse-event \
  -H "Content-Type: application/json" \
  -d '{"text": ""}'
```

### 预期结果
```json
// 测试1 预期输出
{
  "success": true,
  "data": {
    "id": "evt_xxxxxxxx",
    "title": "开会",
    "start": "2026-01-28T15:00:00+08:00",
    "end": "2026-01-28T16:00:00+08:00",
    "isAllDay": false,
    "type": "meeting",
    "meta": {
      "confidence": 0.95,
      "rawInput": "明天下午3点开会",
      "parsedAt": "2026-01-27T10:00:00+08:00"
    }
  }
}

// 测试2 预期输出
{
  "success": true,
  "data": {
    "id": "evt_xxxxxxxx",
    "title": "和老王讨论项目",
    "start": "2026-02-04T12:00:00+08:00",
    "end": "2026-02-04T13:00:00+08:00",
    "isAllDay": false,
    "location": "星巴克",
    "attendees": ["老王"],
    "type": "meeting",
    "meta": {
      "confidence": 0.9,
      "rawInput": "下周三和老王在星巴克讨论项目"
    }
  }
}

// 测试3 预期输出（含重复规则）
{
  "success": true,
  "data": {
    "id": "evt_xxxxxxxx",
    "title": "站会",
    "start": "2026-02-02T09:00:00+08:00",
    "end": "2026-02-02T09:30:00+08:00",
    "isAllDay": false,
    "type": "meeting",
    "recurrence": {
      "freq": "weekly",
      "interval": 1,
      "byDay": ["MO"]
    },
    "meta": {
      "confidence": 0.95
    }
  }
}

// 测试4 预期输出（全天事件）
{
  "success": true,
  "data": {
    "id": "evt_xxxxxxxx",
    "title": "休假",
    "start": "2026-01-30T00:00:00+08:00",
    "end": "2026-01-30T23:59:59+08:00",
    "isAllDay": true,
    "type": "personal",
    "meta": {
      "confidence": 0.95
    }
  }
}

// 测试5 预期输出（错误处理）
{
  "success": false,
  "error": {
    "code": "INVALID_INPUT",
    "message": "请输入日程描述"
  }
}
```

---

## 里程碑3：基础日历视图（前端）

**目标**：渲染日历组件，使用假数据验证显示效果

### 验收标准
在浏览器看到日历界面，假数据事件显示在正确的时间位置

### 验收代码
```tsx
// src/app/page.tsx 中添加测试数据
const mockEvents = [
  {
    id: "1",
    title: "团队周会",
    start: new Date(2026, 0, 28, 10, 0),  // 1月28日 10:00
    end: new Date(2026, 0, 28, 11, 0),
    isAllDay: false,
    type: "meeting",
    createdAt: new Date(),
    updatedAt: new Date()
  },
  {
    id: "2", 
    title: "产品评审",
    start: new Date(2026, 0, 29, 14, 0),  // 1月29日 14:00
    end: new Date(2026, 0, 29, 16, 0),
    isAllDay: false,
    type: "meeting",
    createdAt: new Date(),
    updatedAt: new Date()
  }
];
```

### 预期结果
- 浏览器显示周视图日历
- "团队周会" 显示在 1月28日 10:00-11:00 的位置
- "产品评审" 显示在 1月29日 14:00-16:00 的位置
- 可切换月视图/周视图/日视图
- 按钮和星期显示中文

---

## 里程碑4：输入框 + API 联调

**目标**：打通核心链路，自然语言输入 → AI 解析 → 日历显示

### 验收标准
在浏览器输入框输入自然语言，点击添加后事件出现在日历上

### 验收代码
```
1. 在输入框输入：明天下午3点开会
2. 点击"添加"按钮或按 Enter
3. 等待解析完成
4. 观察日历视图
```

### 预期结果
- 点击添加后按钮显示 "解析中..." 状态
- 解析成功后输入框清空
- 日历上出现 "开会" 事件，位置在明天 15:00-16:00
- 事件显示蓝色（meeting 类型）
- 如果输入为空，显示错误提示 "请输入日程描述"

---

## 里程碑5：解析预览确认

**目标**：AI 解析后先展示预览，用户确认后再添加到日历

### 验收标准
在浏览器看到解析预览弹窗，显示解析结果，点击确认后添加到日历

### 验收代码
```
1. 输入：下周三和老王在星巴克讨论项目
2. 点击添加
3. 弹出预览弹窗，显示：
   - 标题：和老王讨论项目
   - 时间：下周三 12:00 - 13:00
   - 地点：星巴克
   - 参与者：老王
4. 点击"确认添加"
5. 事件出现在日历上
```

### 预期结果
- 弹窗显示解析出的所有信息
- 低置信度时显示黄色警告
- 点击"取消"关闭弹窗，不添加事件
- 点击"确认添加"后事件出现在日历
- 弹窗自动关闭

---

## 里程碑6：事件管理（查看/删除）

**目标**：支持点击日历事件查看详情和删除

### 验收标准
在浏览器点击日历事件，弹出详情弹窗，可删除事件

### 验收代码
```
1. 先添加一个事件：明天下午3点开会
2. 点击日历上的"开会"事件
3. 弹出详情弹窗
4. 点击"删除"按钮
5. 事件从日历消失
```

### 预期结果
- 点击事件弹出详情弹窗
- 弹窗显示标题、时间、地点、参与者
- 点击删除后事件从日历消失
- 点击弹窗外部或"关闭"按钮可关闭弹窗

---

## 里程碑7：数据持久化

**目标**：事件保存到 localStorage，刷新页面不丢失

### 验收标准
在浏览器添加事件后刷新页面，事件仍然存在

### 验收代码
```
1. 添加事件：明天下午3点开会
2. 确认事件显示在日历上
3. 刷新页面（F5 或 Cmd+R）
4. 观察日历
```

### 预期结果
- 刷新后日历仍显示 "开会" 事件
- 删除事件后刷新，事件不再显示
- 首次加载（无数据）时日历正常显示，无报错

---

## 里程碑8：冲突检测

**目标**：新增日程时检测时间冲突，给出警告提示

### 验收标准
在浏览器添加时间重叠的事件时，显示冲突警告

### 验收代码
```
1. 添加事件：明天下午3点开会
2. 再添加事件：明天下午3点半见客户
3. 预览弹窗显示冲突警告
```

### 预期结果
- 预览弹窗显示红色警告：与「开会」时间冲突
- 用户仍可选择确认添加（只是警告，不阻止）
- 无冲突时不显示警告

---

## 里程碑9：快捷输入模板

**目标**：提供常用句式示例，点击即填入输入框

### 验收标准
在浏览器看到快捷模板，点击后文字填入输入框

### 验收代码
```
1. 页面加载后看到快捷模板按钮
2. 点击"明天下午3点开会"模板
3. 输入框自动填入该文字
```

### 预期结果
- 输入框下方显示 3-5 个常用模板按钮
- 点击模板后文字填入输入框
- 输入框获得焦点，用户可直接修改或提交
- 模板示例：
  - 明天下午3点开会
  - 每周一早上9点站会
  - 下周五全天休假

---

## 里程碑10：视图切换 + 样式优化

**目标**：完善日/周/月视图切换，优化整体 UI 样式

### 验收标准
在浏览器流畅切换视图，界面美观统一

### 验收代码
```
1. 点击"月"按钮切换到月视图
2. 点击"周"按钮切换到周视图  
3. 点击"日"按钮切换到日视图
4. 点击"今天"按钮回到当前日期
```

### 预期结果
- 三种视图切换流畅，无卡顿
- 事件在各视图中正确显示
- 不同类型事件颜色区分清晰
- 整体界面风格统一、美观

---

## 开发顺序总览

```
M1 项目初始化        ████░░░░░░░░░░░░░░░░  0.5天
M2 AI解析服务        ████████░░░░░░░░░░░░  1天
M3 日历视图          ████░░░░░░░░░░░░░░░░  0.5天
M4 输入+API联调      ████████░░░░░░░░░░░░  1天
M5 解析预览          ████░░░░░░░░░░░░░░░░  0.5天
M6 事件管理          ████░░░░░░░░░░░░░░░░  0.5天
M7 数据持久化        ████░░░░░░░░░░░░░░░░  0.5天
M8 冲突检测          ██░░░░░░░░░░░░░░░░░░  0.25天
M9 快捷模板          ██░░░░░░░░░░░░░░░░░░  0.25天
M10 视图+样式优化    ████░░░░░░░░░░░░░░░░  0.5天
─────────────────────────────────────────
总计                                      约5天
```

---

## 检查清单

| 里程碑 | 完成 | 备注 |
|--------|------|------|
| M1 项目初始化 | ☐ | |
| M2 AI解析服务 | ☐ | |
| M3 日历视图 | ☐ | |
| M4 输入+API联调 | ☐ | MVP 核心 |
| M5 解析预览 | ☐ | |
| M6 事件管理 | ☐ | |
| M7 数据持久化 | ☐ | |
| M8 冲突检测 | ☐ | |
| M9 快捷模板 | ☐ | |
| M10 视图+样式优化 | ☐ | |

每完成一个里程碑，在对应行打 ✓
